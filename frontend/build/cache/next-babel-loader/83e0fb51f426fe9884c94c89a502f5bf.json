{"ast":null,"code":"var _jsxFileName = \"/Users/jianruan/Developer/webapp/frontend/components/Login.tsx\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport styled from 'styled-components';\nimport { Typography } from '@material-ui/core';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { LogInAction, SignUpAction } from '../store/user/action';\nimport { motion } from 'framer-motion';\nimport InputField from './InputField';\nimport TextBtn from './Button/TextBtn';\nimport RoundedBtn from './Button/RoundedBtn';\nimport { errorMsgMap } from '../utils/types';\nconst Root = styled(motion.div).withConfig({\n  displayName: \"Login__Root\",\n  componentId: \"sc-17prs7x-0\"\n})([\"width:600px;padding:32px 24px;\"]);\nconst Header = styled.div.withConfig({\n  displayName: \"Login__Header\",\n  componentId: \"sc-17prs7x-1\"\n})([\"height:64px;min-height:64px;padding-left:24px;padding-right:24px;text-align:center;\"]);\nconst Form = styled.form.withConfig({\n  displayName: \"Login__Form\",\n  componentId: \"sc-17prs7x-2\"\n})([\"width:320px;display:flex;flex-direction:column;margin:32px auto;\"]);\nconst ErrorBanner = styled.div.withConfig({\n  displayName: \"Login__ErrorBanner\",\n  componentId: \"sc-17prs7x-3\"\n})([\"width:320px;text-align:center;margin-bottom:16px;\"]);\n\nfunction Login({\n  initMode = 'login',\n  onSuccess\n}) {\n  const dispatch = useDispatch();\n  const authError = useSelector(state => state.user.err);\n  const isLoggedin = useSelector(state => state.user.isLoggedin);\n  const {\n    0: mode,\n    1: setMode\n  } = useState(initMode);\n  const {\n    0: email,\n    1: setEmail\n  } = useState('');\n  const {\n    0: pwd,\n    1: setPwd\n  } = useState('');\n  const {\n    0: errMsg,\n    1: setErrMsg\n  } = useState('');\n  useEffect(() => {\n    if (isLoggedin && onSuccess) {\n      onSuccess();\n    }\n\n    if (authError !== null) {\n      console.log('Login dialog : ', authError);\n      const newErroMsg = errorMsgMap.get(authError) || 'Something went wrong';\n      setErrMsg(newErroMsg);\n    } else {\n      setErrMsg('');\n    }\n  }, [isLoggedin, authError]);\n\n  const handleModeChange = mode => {\n    setErrMsg('');\n    setMode(mode);\n  };\n\n  const handleSubmitClick = () => {\n    setErrMsg('');\n\n    if (mode === 'login') {\n      dispatch(LogInAction(email, pwd));\n    } else {\n      dispatch(SignUpAction(email, pwd));\n    }\n  };\n\n  return __jsx(Root, {\n    variants: {\n      visible: {\n        opacity: 1\n      },\n      hidden: {\n        opacity: 0\n      }\n    },\n    initial: \"hidden\",\n    animate: \"visible\",\n    exit: \"hidden\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  }, __jsx(Header, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93\n    },\n    __self: this\n  }, __jsx(Typography, {\n    variant: \"h4\",\n    style: {\n      marginBottom: 8\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94\n    },\n    __self: this\n  }, mode === 'login' ? 'Welcome back' : 'Welcome'), __jsx(Typography, {\n    variant: \"h6\",\n    color: \"textSecondary\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97\n    },\n    __self: this\n  }, mode === 'login' ? 'Log in with your email and password' : 'Create an account to start shopping')), __jsx(Form, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104\n    },\n    __self: this\n  }, errMsg !== '' && __jsx(ErrorBanner, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106\n    },\n    __self: this\n  }, __jsx(Typography, {\n    variant: \"body1\",\n    color: \"error\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }, errMsg)), __jsx(InputField, {\n    type: \"email\",\n    label: \"Email\",\n    value: email,\n    onChange: e => setEmail(e.target.value),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }), __jsx(InputField, {\n    type: \"password\",\n    label: \"Password\",\n    value: pwd,\n    onChange: e => setPwd(e.target.value),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118\n    },\n    __self: this\n  }), __jsx(RoundedBtn, {\n    style: {\n      marginTop: 8\n    },\n    onClick: handleSubmitClick,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125\n    },\n    __self: this\n  }, mode === 'login' ? 'Log in' : 'Sign up'), __jsx(Typography, {\n    variant: \"caption\",\n    style: {\n      textAlign: 'center',\n      marginTop: 16\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  }, mode === 'login' ? \"Don't have an account? \" : 'Already have an account? ', __jsx(TextBtn, {\n    onClick: () => handleModeChange(mode === 'login' ? 'signup' : 'login'),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }, mode === 'login' ? 'Sign up' : 'Log in')), mode === 'login' && __jsx(Typography, {\n    variant: \"caption\",\n    style: {\n      textAlign: 'center',\n      marginTop: 8\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145\n    },\n    __self: this\n  }, \"Forgot password? \\xA0\", __jsx(TextBtn, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150\n    },\n    __self: this\n  }, \"Reset\"))));\n}\n\nexport default Login;","map":{"version":3,"sources":["/Users/jianruan/Developer/webapp/frontend/components/Login.tsx"],"names":["React","useState","useEffect","styled","Typography","useDispatch","useSelector","LogInAction","SignUpAction","motion","InputField","TextBtn","RoundedBtn","errorMsgMap","Root","div","Header","Form","form","ErrorBanner","Login","initMode","onSuccess","dispatch","authError","state","user","err","isLoggedin","mode","setMode","email","setEmail","pwd","setPwd","errMsg","setErrMsg","console","log","newErroMsg","get","handleModeChange","handleSubmitClick","visible","opacity","hidden","marginBottom","e","target","value","marginTop","textAlign"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport styled from 'styled-components'\nimport { Typography } from '@material-ui/core'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { LogInAction, SignUpAction } from '../store/user/action'\nimport { motion } from 'framer-motion'\nimport InputField from './InputField'\nimport TextBtn from './Button/TextBtn'\nimport RoundedBtn from './Button/RoundedBtn'\nimport { errorMsgMap } from '../utils/types'\n\nconst Root = styled(motion.div)`\n  width: 600px;\n  padding: 32px 24px;\n`\n\nconst Header = styled.div`\n  height: 64px;\n  min-height: 64px;\n  padding-left: 24px;\n  padding-right: 24px;\n  text-align: center;\n`\n\nconst Form = styled.form`\n  width: 320px;\n  display: flex;\n  flex-direction: column;\n  margin: 32px auto;\n`\n\nconst ErrorBanner = styled.div`\n  width: 320px;\n  text-align: center;\n  margin-bottom: 16px;\n`\n\ninterface propsValue {\n  initMode?: string\n  onSuccess?: Function\n}\n\nfunction Login({ initMode = 'login', onSuccess }: propsValue) {\n  const dispatch = useDispatch()\n  const authError = useSelector((state: any) => state.user.err)\n  const isLoggedin = useSelector((state: any) => state.user.isLoggedin)\n  const [mode, setMode] = useState(initMode)\n  const [email, setEmail] = useState('')\n  const [pwd, setPwd] = useState('')\n  const [errMsg, setErrMsg] = useState('')\n\n  useEffect(() => {\n    if (isLoggedin && onSuccess) {\n      onSuccess()\n    }\n    if (authError !== null) {\n      console.log('Login dialog : ', authError)\n      const newErroMsg = errorMsgMap.get(authError) || 'Something went wrong'\n      setErrMsg(newErroMsg)\n    } else {\n      setErrMsg('')\n    }\n  }, [isLoggedin, authError])\n\n  const handleModeChange = (mode: string) => {\n    setErrMsg('')\n    setMode(mode)\n  }\n\n  const handleSubmitClick = () => {\n    setErrMsg('')\n    if (mode === 'login') {\n      dispatch(LogInAction(email, pwd))\n    } else {\n      dispatch(SignUpAction(email, pwd))\n    }\n  }\n\n  return (\n    <Root\n      variants={{\n        visible: {\n          opacity: 1\n        },\n        hidden: {\n          opacity: 0\n        }\n      }}\n      initial='hidden'\n      animate='visible'\n      exit='hidden'\n    >\n      <Header>\n        <Typography variant='h4' style={{ marginBottom: 8 }}>\n          {mode === 'login' ? 'Welcome back' : 'Welcome'}\n        </Typography>\n        <Typography variant='h6' color='textSecondary'>\n          {mode === 'login'\n            ? 'Log in with your email and password'\n            : 'Create an account to start shopping'}\n        </Typography>\n      </Header>\n\n      <Form>\n        {errMsg !== '' && (\n          <ErrorBanner>\n            <Typography variant='body1' color='error'>\n              {errMsg}\n            </Typography>\n          </ErrorBanner>\n        )}\n        <InputField\n          type='email'\n          label='Email'\n          value={email}\n          onChange={e => setEmail(e.target.value)}\n        />\n        <InputField\n          type='password'\n          label='Password'\n          value={pwd}\n          onChange={e => setPwd(e.target.value)}\n        />\n\n        <RoundedBtn style={{ marginTop: 8 }} onClick={handleSubmitClick}>\n          {mode === 'login' ? 'Log in' : 'Sign up'}\n        </RoundedBtn>\n\n        <Typography\n          variant='caption'\n          style={{ textAlign: 'center', marginTop: 16 }}\n        >\n          {mode === 'login'\n            ? \"Don't have an account? \"\n            : 'Already have an account? '}\n          <TextBtn\n            onClick={() =>\n              handleModeChange(mode === 'login' ? 'signup' : 'login')\n            }\n          >\n            {mode === 'login' ? 'Sign up' : 'Log in'}\n          </TextBtn>\n        </Typography>\n        {mode === 'login' && (\n          <Typography\n            variant='caption'\n            style={{ textAlign: 'center', marginTop: 8 }}\n          >\n            Forgot password? &nbsp;\n            <TextBtn>Reset</TextBtn>\n          </Typography>\n        )}\n      </Form>\n    </Root>\n  )\n}\n\nexport default Login\n"]},"metadata":{},"sourceType":"module"}